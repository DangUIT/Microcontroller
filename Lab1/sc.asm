ORG 0H
	
MAIN:
	CALL E2
;;EFFECT1: DEN SANG ROI TAT LAN LUOT 
	EFFECT1:
		CALL E3
;;EFFECT2: DEN SANG CHAN LE
	MOV R2,#35
	EFFECT2:
		CALL E5
		DJNZ R2,EFFECT2
;;EFFECT3: DEN SANG TAT LIEN TUC
	MOV R3,#25D
	EFFECT3:
		CALL E1
		CALL E2
		DJNZ R3,EFFECT3
	SJMP MAIN
;;E1 : TAT CA DEN SANG
E1:
	MOV P0,#00H
	MOV P1,#00H
	MOV P2,#00H
	MOV P3,#00H
	CALL DELAY100MS
RET
;;E2 : TAT CA DEN TAT
E2:
	MOV P0,#0FFH
	MOV P1,#0FFH
	MOV P2,#0FFH
	MOV P3,#0FFH
	CALL DELAY100MS
RET

;;E3: LED SANG DAN
E3:
	MOV A,#0FFH
	CLR C
E3_P0:
	RLC A
	MOV P0,A
	CALL DELAY100MS
	CJNE A,#00H,E3_P0
	MOV A,#0FFH
E3_P1:
	RLC A
	MOV P1,A
	CALL DELAY100MS
	CJNE A,#00H,E3_P1
	MOV A,#0FFH
E3_P2:
	RLC A
	MOV P2,A
	CALL DELAY100MS
	CJNE A,#00H,E3_P2
	MOV A,#0FFH
E3_P3:
	RLC A
	MOV P3,A
	CALL DELAY100MS
	CJNE A,#00H,E3_P3


;;E4: LED TAT DAN
E4:
E4_P0:
	SETB C
	RLC A
	MOV P0,A
	CALL DELAY100MS
	CJNE A,#0FFH,E4_P0
	MOV A,#00H
E4_P1:
	SETB C
	RLC A
	MOV P1,A
	CALL DELAY100MS
	CJNE A,#0FFH,E4_P1
	MOV A,#00H
E4_P2:
	SETB C
	RLC A
	MOV P2,A
	CALL DELAY100MS
	CJNE A,#0FFH,E4_P2
	MOV A,#00H
E4_P3:
	SETB C
	RLC A
	MOV P3,A
	CALL DELAY100MS
	CJNE A,#0FFH,E4_P3
RET
	
;;E5: DEN SANG CHAN LE
E5:
	MOV P0,#01010101B
	MOV P1,#01010101B
	MOV P2,#01010101B
	MOV P3,#01010101B
	CALL DELAY100MS
	MOV P0,#10101010B
	MOV P1,#10101010B
	MOV P2,#10101010B
	MOV P3,#10101010B
	CALL DELAY100MS
RET
;;Ham delay

DELAY100MS:
	MOV R5,#2D
	DELAY:
		MOV TMOD,#01H
		MOV TH0,#HIGH(-50000D)
		MOV TL0,#LOW(-50000D)
		SETB TR0
		JNB TF0,$
		CLR TF0
		DJNZ R5,DELAY
RET
END
	